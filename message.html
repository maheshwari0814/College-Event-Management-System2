<!-- Contact Messages Section -->
<section>
  <h2 style="text-align:center; margin-top:30px;">Contact Messages</h2>
  <table id="messagesTable" border="1" style="width:100%; border-collapse:collapse; background:white; box-shadow:0 0 10px rgba(0,0,0,0.1);">
    <thead>
      <tr style="background-color:#007bff; color:white;">
        <th>Name</th>
        <th>Email</th>
        <th>Message</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="messageBody"></tbody>
  </table>
</section>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
  import { getDatabase, ref, onValue, remove } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDy72PKH73uVD8VE9iC-g58yHmQIYlUld8",
    authDomain: "college-event-management-cca69.firebaseapp.com",
    projectId: "college-event-management-cca69",
    storageBucket: "college-event-management-cca69.firebasestorage.app",
    messagingSenderId: "200279171351",
    appId: "1:200279171351:web:165da6f529e773bfd95752"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const msgTableBody = document.getElementById("messageBody");
  const msgRef = ref(db, "messages");

  onValue(msgRef, (snapshot) => {
    msgTableBody.innerHTML = "";
    snapshot.forEach((childSnapshot) => {
      const data = childSnapshot.val();
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${data.name}</td>
        <td>${data.email}</td>
        <td>${data.message}</td>
        <td><button style="background:red; color:white; border:none; padding:6px 12px; border-radius:5px; cursor:pointer;" onclick="deleteMessage('${childSnapshot.key}')">Delete</button></td>
      `;
      msgTableBody.appendChild(row);
    });
  });

  // âœ… Delete Message
  window.deleteMessage = function (id) {
    const msgRef = ref(db, "messages/" + id);
    remove(msgRef)
      .then(() => alert("Message deleted successfully!"))
      .catch((error) => alert("Error: " + error));
  };
</script>
